CREATE TABLE IF NOT EXISTS SALESMAN(
  SALESMAN_ID TEXT PRIMARY KEY,
  S_NAME TEXT,
  S_CITY TEXT,
  COMMISSION REAL
);

INSERT INTO SALESMAN (SALESMAN_ID, S_NAME, S_CITY, COMMISSION) VALUES
('46','JOHN','LONDON',0.14),
('87','NANCY','DELHI',0.44),
('56','NICK','LONDON',0.23),
('54','JAS','PARIS',0.14),
('44','NINA','LONDON',0.65);

CREATE TABLE IF NOT EXISTS CUSTOMERS(
  CUSTOMER_ID TEXT PRIMARY KEY,
  NAME TEXT,
  CITY TEXT,
  GRADE INTEGER,
  SALESMAN_ID TEXT,
  FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)
);

INSERT INTO CUSTOMERS(CUSTOMER_ID, NAME, CITY, GRADE, SALESMAN_ID) VALUES
('5001', 'James Hoog', 'New York', 100, '46'),
('5002', 'Nail Knite', 'Paris', 500, '56'),
('5005', 'Pit Alex', 'London', 100, '54'),
('5006', 'Mc Lyon', 'Paris', 300, '44'),
('5007', 'Paul Adam', 'Rome', 500, '87'),
('5003', 'Lauson Hen', 'San Jose', NULL, '46');

CREATE TABLE IF NOT EXISTS ORDERS(
  ORD_NO TEXT PRIMARY KEY,
  PURCH_AMT REAL,
  ORD_DATE TEXT,
  CUSTOMER_ID TEXT,
  SALESMAN_ID TEXT,
  FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(CUSTOMER_ID),
  FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)
);

INSERT INTO ORDERS (ORD_NO, PURCH_AMT, ORD_DATE, CUSTOMER_ID, SALESMAN_ID) VALUES
('70001', 150.5, '2012-10-05', '5001', '46'),
('70009', 270.65, '2012-09-10', '5002', '56'),
('70002', 65.26, '2012-10-05', '5002', '54'),
('70004', 110.5, '2012-08-17', '5006', '56'),
('70007', 948.5, '2012-09-10', '5007', '87'),
('70005', 2400.6, '2012-07-27', '5001', '46');

SELECT CUSTOMERS.NAME, SALESMAN.S_NAME, SALESMAN.S_CITY
FROM CUSTOMERS
JOIN SALESMAN ON CUSTOMERS.CITY = SALESMAN.S_CITY;

SELECT CUSTOMERS.NAME, SALESMAN.S_NAME
FROM CUSTOMERS
JOIN SALESMAN ON CUSTOMERS.SALESMAN_ID = SALESMAN.SALESMAN_ID;

SELECT ORDERS.ORD_NO, CUSTOMERS.NAME, ORDERS.CUSTOMER_ID, ORDERS.SALESMAN_ID
FROM ORDERS
JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID
JOIN SALESMAN ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE CUSTOMERS.CITY <> SALESMAN.S_CITY;

SELECT ORDERS.ORD_NO, CUSTOMERS.NAME
FROM ORDERS
JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID;

SELECT CUSTOMERS.NAME AS "CUSTOMER", CUSTOMERS.GRADE AS "GRADE"
FROM ORDERS
JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID
WHERE CUSTOMERS.GRADE IS NOT NULL;

SELECT CUSTOMERS.NAME AS "CUSTOMER",
CUSTOMERS.CITY AS "CITY",
SALESMAN.S_NAME AS "SALESMAN",
SALESMAN.COMMISSION
FROM CUSTOMERS
JOIN SALESMAN ON CUSTOMERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE SALESMAN.COMMISSION BETWEEN 0.12 AND 0.20;

SELECT ORDERS.ORD_NO, CUSTOMERS.NAME, SALESMAN.COMMISSION AS "COMMISSION%",
ORDERS.PURCH_AMT * SALESMAN.COMMISSION AS "COMMISSION_AMOUNT"
FROM ORDERS
JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID
JOIN SALESMAN ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE CUSTOMERS.GRADE >= 200;

SELECT *
FROM CUSTOMERS
JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
WHERE ORDERS.ORD_DATE = '2012-10-05';

